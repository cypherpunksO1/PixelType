{% extends 'index.html' %}

{% block head_content %}
<meta property="og:type" content="article">
<meta property="og:title" content="PixelType">
<meta property="og:site_name" content="PixelType">
<meta property="og:url" content="/{{post.key}}">
<meta property="og:description" content="{{ post.text | striptags }}">
<meta property="og:image" content="/media/{{ post.key }}.jpeg">
<meta property="author" content="{{ post.author }}">
<meta name="author" content="{{ post.author }}">
<meta property="tg:site_verification" content="g7j8/rPFXfhyrq5q0QQV7EsYWv4=">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<link rel="stylesheet" href="/static/css/file_input.css" type="text/css">
<link rel="stylesheet" href="/static/css/hilights.css" type="text/css">
<link rel="stylesheet" href="/static/css/style.css" type="text/css">  
{% endblock %}

{% block content %}

<style>
    :root {
        --window-size: 700px;
    }
    p, i, em {
        margin-top: -20px;
        padding: 0;
    }

    img {
        width: var(--window-size);
        border-radius: 15px;
        width: 100%;
    }

    @media (max-width: 1000px) {
        img {
            width: var(--window-size);
            border-radius: 5px;
            width: 100%;
        }
    }

    textarea {
        background: transparent;
        border: 1px solid var(--main-bg-color);
        outline: none;
        resize: none;
        width: 100%;
        min-height: 50px;
        margin-top: 20px;
        font-size: 20px;
        margin-top: -10px;
    }

    input {
        background: transparent;
        border: 1px solid var(--main-bg-color);
        outline: none;
        resize: none;
        width: calc(100% - 10px);
        min-height: 50px;
        margin-top: 20px;
        font-family: var(--text-font);
        font-size: var(--text-size);
    }
</style>

<body>

<div id="body" style="padding-bottom: 150px; padding-top: 20px;" class="d-flex align-items-center justify-content-center">
    <div class="container-6" style="width: 800px;">
        <p style="margin-top: 15px; margin-left: 2px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center;" id="authorInput">
            <span><mark class="roman" style="border-radius: 5px; padding: 7px 7px 7px 7px">{{ post.author }}</mark></span> ‚Ä¢ 
            <span><span style="border-radius: 5px; padding: 7px 7px 7px 7px">created {{ created }}</mark></span> ‚Ä¢ 
            <span><span style="border-radius: 5px; padding: 7px 7px 7px 7px">{{ post.views }} eyes</mark></span><br>
        </p>
        <h1 id="titleInput" class="display-4" style="font-weight: 700;">{{ post.title }}</h1>
        <br>
        <button
            class="btn btn-outline-secondary"
            onclick="copyToClipboard(window.location.href);">
            Copy link üîó
        </button>
        <br><br>
        <p class="text" style="word-wrap: break-word;">{{ post.text | safe }}</p>
        <br><br>
        <hr>
        <br><br>
        <span class="badge text-bg-warning">beta</span>
        <h1 style="font-family: BoldFont;">Comments</h1>
        <br>
        <!-- <input class="roman" id="commentAuthorInput" type="text" placeholder="Author">
        <label for="commentTextInput"></label>
        <textarea placeholder="Comment..." name="" id="commentTextInput"></textarea> -->
        <form class="form-floating">
            <input type="email" class="form-control" id="commentAuthorInput" placeholder="Author">
            <label for="commentAuthorInput">Author</label>
          </form>
          <br>
        <div class="form-floating">
            <textarea class="form-control" placeholder="Leave a comment here" id="commentTextInput" style="height: 100px"></textarea>
            <label for="commentTextInput">Comment</label>
        </div>
        <br>
        <button style="margin-top: -10px;" type="button" class="btn btn-success" id="createCommentButton">Leave comment</button>
        <br><br><br><br>
        <div id="comments"></div>
    </div>
</div>

<script src="/static/js/index.js"></script>
<script>
    document.getElementById('commentAuthorInput').value = localStorage.getItem('author');
    
    getPostComments('{{ post.key }}')

    document.getElementById("createCommentButton").onclick = function() {
        createComment('{{ post.key }}');
    }
    const title_textarea = document.getElementById('commentTextInput');

    title_textarea.addEventListener('input', function () {
        this.style.height = 'auto';
        this.style.height = this.scrollHeight + 'px';
    });

    document.addEventListener("DOMContentLoaded", function () {
        // –ù–∞–π—Ç–∏ –≤—Å–µ –±–ª–æ–∫–∏ —Å —Ç–µ–≥–æ–º code
        var codeBlocks = document.querySelectorAll("code");

        for (var i = 0; i < codeBlocks.length; i++) {
            var codeBlock = codeBlocks[i];

            // –°–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥"
            var copyButton = document.createElement("a");
            copyButton.style.cursor = "pointer";
            copyButton.style.marginBottom = "10px";
            copyButton.innerHTML = "Copy";

            copyButton.classList.add("copy-button");
            codeBlock.parentNode.insertBefore(copyButton, codeBlock);

            // –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥"
            copyButton.addEventListener("click", function () {
                // –í—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ –±–ª–æ–∫–µ —Å —Ç–µ–≥–æ–º code
                var selection = window.getSelection();
                var range = document.createRange();
                range.selectNodeContents(this.nextElementSibling);
                selection.removeAllRanges();
                selection.addRange(range);

                // –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
                document.execCommand("copy");

                // –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
                selection.removeAllRanges();

                // –ò–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –Ω–∞ "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!"
                this.innerHTML = "Copied to clipboard!";

                // –í–µ—Ä–Ω—É—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                var button = this;
                setTimeout(function () {
                    button.innerHTML = "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥";
                }, 3000);
            });
        }
    });
</script>
{% endblock %}
